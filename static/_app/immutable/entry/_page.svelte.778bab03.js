import{S as he,i as me,s as pe,k as b,q as G,a as M,e as x,l as g,m as y,r as C,h as i,c as j,n as f,b as V,G as c,J as Q,K as z,L as ve,u as Z,H,M as be,N as oe,y as ge,z as ke,A as ye,g as Ee,d as Ie,B as we}from"../chunks/index.259c4853.js";function ie(n,e,t){const l=n.slice();return l[19]=e[t].id,l[20]=e[t].source,l[21]=e[t].text,l}function ue(n,e,t){const l=n.slice();return l[24]=e[t],l[26]=t,l}function Te(n){let e,t;return{c(){e=b("div"),t=b("input"),this.h()},l(l){e=g(l,"DIV",{class:!0});var r=y(e);t=g(r,"INPUT",{type:!0,class:!0}),r.forEach(i),this.h()},h(){f(t,"type","submit"),t.value="Join Game",f(t,"class","horizontal-submit"),f(e,"class","column")},m(l,r){V(l,e,r),c(e,t)},p:H,d(l){l&&i(e)}}}function De(n){let e,t,l,r,a;return{c(){e=b("div"),t=b("button"),l=G("Leave Game"),this.h()},l(_){e=g(_,"DIV",{class:!0});var d=y(e);t=g(d,"BUTTON",{type:!0,class:!0});var u=y(t);l=C(u,"Leave Game"),u.forEach(i),d.forEach(i),this.h()},h(){f(t,"type","button"),f(t,"class","horizontal-submit"),f(e,"class","column")},m(_,d){V(_,e,d),c(e,t),c(t,l),r||(a=z(t,"click",n[9]),r=!0)},p:H,d(_){_&&i(e),r=!1,a()}}}function ce(n){let e,t,l,r,a,_,d,u,v,s,m,E,P,J,w,L,U,Y,A,B,R,D,S;function T(o,O){return o[4]?o[6].winner?Pe:o[6].turn===o[5]?Ve:Ne:Ue}let p=T(n),k=p(n),F=n[6].board,I=[];for(let o=0;o<F.length;o+=1)I[o]=fe(ue(n,F,o));let q=n[6].chat,N=[];for(let o=0;o<q.length;o+=1)N[o]=de(ie(n,q,o));return{c(){e=b("div"),k.c(),t=M(),l=b("div"),r=b("div"),a=b("div");for(let o=0;o<I.length;o+=1)I[o].c();_=M(),d=b("div"),u=b("div"),v=b("h2"),s=G("Chat"),m=M(),E=b("div");for(let o=0;o<N.length;o+=1)N[o].c();P=M(),J=b("form"),w=b("div"),L=b("div"),U=b("input"),Y=M(),A=b("div"),B=b("input"),this.h()},l(o){e=g(o,"DIV",{class:!0});var O=y(e);k.l(O),O.forEach(i),t=j(o),l=g(o,"DIV",{class:!0});var h=y(l);r=g(h,"DIV",{class:!0});var W=y(r);a=g(W,"DIV",{class:!0});var ee=y(a);for(let X=0;X<I.length;X+=1)I[X].l(ee);ee.forEach(i),W.forEach(i),_=j(h),d=g(h,"DIV",{class:!0});var te=y(d);u=g(te,"DIV",{id:!0});var K=y(u);v=g(K,"H2",{});var le=y(v);s=C(le,"Chat"),le.forEach(i),m=j(K),E=g(K,"DIV",{class:!0});var ne=y(E);for(let X=0;X<N.length;X+=1)N[X].l(ne);ne.forEach(i),P=j(K),J=g(K,"FORM",{});var re=y(J);w=g(re,"DIV",{class:!0});var $=y(w);L=g($,"DIV",{class:!0});var ae=y(L);U=g(ae,"INPUT",{type:!0,id:!0,name:!0,placeholder:!0}),ae.forEach(i),Y=j($),A=g($,"DIV",{class:!0});var se=y(A);B=g(se,"INPUT",{type:!0}),se.forEach(i),$.forEach(i),re.forEach(i),K.forEach(i),te.forEach(i),h.forEach(i),this.h()},h(){f(e,"class","status"),f(a,"class","game-board"),f(r,"class","column"),f(E,"class","chat-messages"),f(U,"type","text"),f(U,"id","chat-msg"),f(U,"name","msg"),f(U,"placeholder","Message"),f(L,"class","column"),f(B,"type","submit"),B.value="Send",B.disabled=R=!n[3]||!n[7],f(A,"class","column"),f(w,"class","row"),f(u,"id","chat"),f(d,"class","column"),f(l,"class","row")},m(o,O){V(o,e,O),k.m(e,null),V(o,t,O),V(o,l,O),c(l,r),c(r,a);for(let h=0;h<I.length;h+=1)I[h]&&I[h].m(a,null);c(l,_),c(l,d),c(d,u),c(u,v),c(v,s),c(u,m),c(u,E);for(let h=0;h<N.length;h+=1)N[h]&&N[h].m(E,null);c(u,P),c(u,J),c(J,w),c(w,L),c(L,U),Q(U,n[0]),c(w,Y),c(w,A),c(A,B),D||(S=[z(U,"input",n[17]),z(J,"submit",ve(n[10]))],D=!0)},p(o,O){if(p===(p=T(o))&&k?k.p(o,O):(k.d(1),k=p(o),k&&(k.c(),k.m(e,null))),O&2160){F=o[6].board;let h;for(h=0;h<F.length;h+=1){const W=ue(o,F,h);I[h]?I[h].p(W,O):(I[h]=fe(W),I[h].c(),I[h].m(a,null))}for(;h<I.length;h+=1)I[h].d(1);I.length=F.length}if(O&64){q=o[6].chat;let h;for(h=0;h<q.length;h+=1){const W=ie(o,q,h);N[h]?N[h].p(W,O):(N[h]=de(W),N[h].c(),N[h].m(E,null))}for(;h<N.length;h+=1)N[h].d(1);N.length=q.length}O&1&&U.value!==o[0]&&Q(U,o[0]),O&136&&R!==(R=!o[3]||!o[7])&&(B.disabled=R)},d(o){o&&i(e),k.d(),o&&i(t),o&&i(l),oe(I,o),oe(N,o),D=!1,be(S)}}}function Ne(n){let e;return{c(){e=G("Opponent's turn")},l(t){e=C(t,"Opponent's turn")},m(t,l){V(t,e,l)},p:H,d(t){t&&i(e)}}}function Ve(n){let e;return{c(){e=G("Your turn")},l(t){e=C(t,"Your turn")},m(t,l){V(t,e,l)},p:H,d(t){t&&i(e)}}}function Pe(n){let e;function t(a,_){return a[6].winner==="Draw"?Ge:a[6].winner.Win===a[5]?Oe:Se}let l=t(n),r=l(n);return{c(){r.c(),e=x()},l(a){r.l(a),e=x()},m(a,_){r.m(a,_),V(a,e,_)},p(a,_){l!==(l=t(a))&&(r.d(1),r=l(a),r&&(r.c(),r.m(e.parentNode,e)))},d(a){r.d(a),a&&i(e)}}}function Ue(n){let e;return{c(){e=G("Waiting for opponent...")},l(t){e=C(t,"Waiting for opponent...")},m(t,l){V(t,e,l)},p:H,d(t){t&&i(e)}}}function Se(n){let e;return{c(){e=G("You lost!")},l(t){e=C(t,"You lost!")},m(t,l){V(t,e,l)},d(t){t&&i(e)}}}function Oe(n){let e;return{c(){e=G("You won!")},l(t){e=C(t,"You won!")},m(t,l){V(t,e,l)},d(t){t&&i(e)}}}function Ge(n){let e;return{c(){e=G("Draw!")},l(t){e=C(t,"Draw!")},m(t,l){V(t,e,l)},d(t){t&&i(e)}}}function fe(n){let e,t=n[24]+"",l,r,a,_,d,u;function v(){return n[16](n[26])}return{c(){e=b("button"),l=G(t),r=M(),this.h()},l(s){e=g(s,"BUTTON",{type:!0,class:!0});var m=y(e);l=C(m,t),r=j(m),m.forEach(i),this.h()},h(){f(e,"type","button"),f(e,"class",a="game-square "+n[24]),e.disabled=_=!n[4]||n[6].turn!==n[5]||n[24]!==" "},m(s,m){V(s,e,m),c(e,l),c(e,r),d||(u=z(e,"click",v),d=!0)},p(s,m){n=s,m&64&&t!==(t=n[24]+"")&&Z(l,t),m&64&&a!==(a="game-square "+n[24])&&f(e,"class",a),m&112&&_!==(_=!n[4]||n[6].turn!==n[5]||n[24]!==" ")&&(e.disabled=_)},d(s){s&&i(e),d=!1,u()}}}function Ce(n){var u;let e,t=((u=_e(n[6],n[20].Player))==null?void 0:u.name)+"",l,r,a=n[20].Player+"",_,d;return{c(){e=b("span"),l=G(t),r=G(" ("),_=G(a),d=G("):"),this.h()},l(v){e=g(v,"SPAN",{class:!0});var s=y(e);l=C(s,t),r=C(s," ("),_=C(s,a),d=C(s,"):"),s.forEach(i),this.h()},h(){f(e,"class","chat-message-player")},m(v,s){V(v,e,s),c(e,l),c(e,r),c(e,_),c(e,d)},p(v,s){var m;s&64&&t!==(t=((m=_e(v[6],v[20].Player))==null?void 0:m.name)+"")&&Z(l,t),s&64&&a!==(a=v[20].Player+"")&&Z(_,a)},d(v){v&&i(e)}}}function Je(n){let e,t;return{c(){e=b("span"),t=G("Server:"),this.h()},l(l){e=g(l,"SPAN",{class:!0});var r=y(e);t=C(r,"Server:"),r.forEach(i),this.h()},h(){f(e,"class","chat-message-server")},m(l,r){V(l,e,r),c(e,t)},p:H,d(l){l&&i(e)}}}function de(n){let e,t,l,r=n[21]+"",a,_,d;function u(m,E){return m[20]==="System"?Je:Ce}let v=u(n),s=v(n);return{c(){e=b("div"),s.c(),t=M(),l=b("span"),a=G(r),_=M(),this.h()},l(m){e=g(m,"DIV",{class:!0,id:!0});var E=y(e);s.l(E),t=j(E),l=g(E,"SPAN",{class:!0});var P=y(l);a=C(P,r),P.forEach(i),_=j(E),E.forEach(i),this.h()},h(){f(l,"class","chat-message-text"),f(e,"class","chat-message"),f(e,"id",d=`chat-message-${n[19]}`)},m(m,E){V(m,e,E),s.m(e,null),c(e,t),c(e,l),c(l,a),c(e,_)},p(m,E){v===(v=u(m))&&s?s.p(m,E):(s.d(1),s=v(m),s&&(s.c(),s.m(e,t))),E&64&&r!==(r=m[21]+"")&&Z(a,r),E&64&&d!==(d=`chat-message-${m[19]}`)&&f(e,"id",d)},d(m){m&&i(e),s.d()}}}function Me(n){let e,t,l,r,a,_,d,u,v,s,m,E=n[3]?"Code For Others to Join You":"Game Token",P,J,w,L,U,Y,A,B;function R(p,k){return p[3]?De:Te}let D=R(n),S=D(n),T=n[3]&&ce(n);return{c(){e=b("div"),t=b("form"),l=b("div"),r=b("div"),a=b("label"),_=G("Player Name"),d=M(),u=b("input"),v=M(),s=b("div"),m=b("label"),P=G(E),J=M(),w=b("input"),L=M(),S.c(),U=M(),T&&T.c(),Y=x(),this.h()},l(p){e=g(p,"DIV",{id:!0});var k=y(e);t=g(k,"FORM",{id:!0});var F=y(t);l=g(F,"DIV",{class:!0});var I=y(l);r=g(I,"DIV",{class:!0});var q=y(r);a=g(q,"LABEL",{for:!0});var N=y(a);_=C(N,"Player Name"),N.forEach(i),d=j(q),u=g(q,"INPUT",{type:!0,id:!0,name:!0,placeholder:!0}),q.forEach(i),v=j(I),s=g(I,"DIV",{class:!0});var o=y(s);m=g(o,"LABEL",{for:!0});var O=y(m);P=C(O,E),O.forEach(i),J=j(o),w=g(o,"INPUT",{type:!0,id:!0,name:!0,placeholder:!0}),o.forEach(i),L=j(I),S.l(I),I.forEach(i),F.forEach(i),k.forEach(i),U=j(p),T&&T.l(p),Y=x(),this.h()},h(){f(a,"for","player-name"),f(u,"type","text"),f(u,"id","player-name"),f(u,"name","name"),f(u,"placeholder","Player Name"),u.readOnly=n[3],f(r,"class","column"),f(m,"for","join-token"),f(w,"type","text"),f(w,"id","join-token"),f(w,"name","token"),f(w,"placeholder","Join Token (Leave blank for new game)"),w.readOnly=n[3],f(s,"class","column"),f(l,"class","row"),f(t,"id","join-game-form"),f(e,"id","menu")},m(p,k){V(p,e,k),c(e,t),c(t,l),c(l,r),c(r,a),c(a,_),c(r,d),c(r,u),Q(u,n[2]),c(l,v),c(l,s),c(s,m),c(m,P),c(s,J),c(s,w),Q(w,n[1]),c(l,L),S.m(l,null),V(p,U,k),T&&T.m(p,k),V(p,Y,k),A||(B=[z(u,"input",n[13]),z(w,"click",n[14]),z(w,"input",n[15]),z(t,"submit",ve(n[8]))],A=!0)},p(p,[k]){k&8&&(u.readOnly=p[3]),k&4&&u.value!==p[2]&&Q(u,p[2]),k&8&&E!==(E=p[3]?"Code For Others to Join You":"Game Token")&&Z(P,E),k&8&&(w.readOnly=p[3]),k&2&&w.value!==p[1]&&Q(w,p[1]),D===(D=R(p))&&S?S.p(p,k):(S.d(1),S=D(p),S&&(S.c(),S.m(l,null))),p[3]?T?T.p(p,k):(T=ce(p),T.c(),T.m(Y.parentNode,Y)):T&&(T.d(1),T=null)},i:H,o:H,d(p){p&&i(e),S.d(),p&&i(U),T&&T.d(p),p&&i(Y),A=!1,be(B)}}}function _e(n,e){return n.players.find(t=>t.team===e)}function je(n,e,t){let{socketUrl:l}=e,r="",a="",_=!1,d=!1,u="X",v={turn:"X",winner:null,players:[],board:[" "," "," "," "," "," "," "," "," "],chat:[]},s=null;function m(){_||(console.log("Joining game with player name:",a,"and join token:",r),s=new WebSocket("ws://"+l+"ws?token="+encodeURIComponent(r)+"&name="+encodeURIComponent(a)),s.onopen=()=>{t(0,P=""),t(3,_=!0)},s.onmessage=D=>{console.debug("Got Msg From Server:",D);const S=JSON.parse(D.data);console.debug("json",S);const T=Object.keys(S)[0].toString(),p=S[T];if(T==="JoinedGame"){const{token:k,team:F,state:I}=p;t(1,r=k),t(6,v=I),t(5,u=F),t(4,d=v.players.length===2)}else T==="GameState"?(t(6,v=p),t(4,d=v.players.length===2)):T==="Error"?(console.error("Error from server",p),window.alert(p)):console.error("Unknown message type",T)},s.onclose=()=>{t(3,_=!1),t(1,r=""),console.log("disconnected by server")},s.onerror=D=>{console.error("error",D)})}function E(){console.log("Leaving game"),s&&s.close()}let P="",J=!1;function w(){s&&J&&(s.send(JSON.stringify({ChatMsg:{text:P}})),t(0,P=""))}function L(D){if(s){if(!d){console.warn("not enough players to play");return}s.send(JSON.stringify({Move:{space:D}}))}}function U(){a=this.value,t(2,a)}const Y=D=>{_&&(D.currentTarget.select(),navigator.clipboard.writeText(r))};function A(){r=this.value,t(1,r)}const B=D=>L(D);function R(){P=this.value,t(0,P)}return n.$$set=D=>{"socketUrl"in D&&t(12,l=D.socketUrl)},n.$$.update=()=>{n.$$.dirty&1&&t(7,J=(P||"").replace(/^\s+|\s+$/gm,"").length>0)},[P,r,a,_,d,u,v,J,m,E,w,L,l,U,Y,A,B,R]}class Le extends he{constructor(e){super(),me(this,e,je,Me,pe,{socketUrl:12})}}function Ye(n){let e,t,l,r,a,_;return a=new Le({props:{socketUrl:n[0].socketUrl}}),{c(){e=b("div"),t=b("h1"),l=G("Tic Tac Toe"),r=M(),ge(a.$$.fragment),this.h()},l(d){e=g(d,"DIV",{class:!0});var u=y(e);t=g(u,"H1",{});var v=y(t);l=C(v,"Tic Tac Toe"),v.forEach(i),r=j(u),ke(a.$$.fragment,u),u.forEach(i),this.h()},h(){f(e,"class","container")},m(d,u){V(d,e,u),c(e,t),c(t,l),c(e,r),ye(a,e,null),_=!0},p(d,[u]){const v={};u&1&&(v.socketUrl=d[0].socketUrl),a.$set(v)},i(d){_||(Ee(a.$$.fragment,d),_=!0)},o(d){Ie(a.$$.fragment,d),_=!1},d(d){d&&i(e),we(a)}}}function Ae(n,e,t){let{data:l}=e;return n.$$set=r=>{"data"in r&&t(0,l=r.data)},[l]}class Fe extends he{constructor(e){super(),me(this,e,Ae,Ye,pe,{data:0})}}export{Fe as default};
